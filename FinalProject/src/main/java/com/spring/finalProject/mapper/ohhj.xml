<?xml version="1.0" encoding="UTF-8"?>

<!-- ==== #29. mapper 기본설정 ==== --> <!-- mybatis를 사용함 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- ==== #29. 루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체내에서 유일해야 한다.) ==== -->
<mapper namespace="ohhj"> <!-- ohhj는 고유해야하는 식별자이므로, hr.xml에도 namespace명을 똑같이하게되면 충돌난다. => 보통 파일명과 일치시킨다. -->

	
	<!-- === &57. 글쓰기(파일첨부가 없는 글쓰기) === -->
	<insert id="boardWrite" parameterType="com.spring.board.model.BoardVO_OHJ">
		insert into tbl_board(boardSeq, fk_bCategorySeq, fk_employeeId, subject, content, regDate, readCount)
		values(tbl_board_boardSeq.nextval, #{fk_bCategorySeq}, #{fk_employeeId}, #{subject}, #{content}, default, default)
	</insert>
	
	
	<!-- === &61. 페이징 처리를 안한 검색어가 없는 전체 글목록 보여주기 === -->
	<select id="boardListNoSearch" resultType="com.spring.board.model.BoardVO_OHJ">
		select boardSeq, subject, name, to_char(regDate, 'yyyy-mm-dd hh24:mi:ss') as regDate, readCount
		from tbl_board B JOIN tbl_employee E
		ON B.fk_employeeId = E.employeeId
		order by regDate desc
	</select>
	
	
	<!-- === &65. 글1개 조회하기 === -->
	<select id="getView" parameterType="HashMap" resultType="com.spring.board.model.BoardVO_OHJ">
		select boardSeq, bCategoryName, subject, fk_employeeid, name, positionName, content, to_char(regDate, 'yyyy-mm-dd hh24:mi:ss') as regDate, readCount
		from tbl_board B JOIN tbl_boardCategory C
		ON B.fk_bCategorySeq = C.bCategorySeq
		JOIN tbl_employee E
		ON B.fk_employeeId = E.employeeId
		JOIN tbl_position P
		ON E.fk_positionNo = P.positionNo
		where boardSeq = #{boardSeq}
	</select>
	
	<!-- === &67. 글조회수 1증가 하기 === -->
	<update id="addReadCount" parameterType="String">
		update tbl_board set readCount = readCount + 1
		where boardSeq = #{boardSeq}
	</update>
	
	
	
	
	
	
</mapper>